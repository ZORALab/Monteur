+++
date = "2021-12-02T08:22:42+08:00"
title = "Build"
description = """
Monteur provides Build CI Job to build your production-ready project or app with
consistent reproducilibity properties.
"""
keywords = [
	"Build",
	"CI job",
	"Build CI Job",
	"ZORALab's Monteur",
	"configurations",
	"documentation",
]
draft = false
type = ""
# redirectURL=""
layout = "list"


[robots]
[robots.googleBot]
name = "googleBot"
content = ""


[modules]
extensions = [
	# Example: "sidebar",
]


[creators.holloway]
"@type" = "Person"
"name" = "'Holloway' Chew Kean Ho"


[thumbnails.0]
url = "/en/ci-jobs/build/default-1200x628.png"
width = "1200"
height = "628"
alternateText = "ZORALab's Monteur Build CI Job"

[thumbnails.1]
url = "/en/ci-jobs/build/default-1200x1200.png"
width = "1200"
height = "1200"
alternateText = "ZORALab's Monteur Build CI Job"

[thumbnails.2]
url = "/en/ci-jobs/build/default-480x480.png"
type = "image/png"
width = "480"
height = "480"
alternateText = "ZORALab's Monteur Build CI Job"


[menu.main]
parent = "CI Jobs"
name = "Build"
pre = "ðŸ§°"
weight = 70
identifier = "ci-jobs-build"


[schema]
selectType = "WebPage"
+++

<section id="introduction">
	<h1>{{% param "title" %}}</h1>
	<p>
		{{% param "description" %}}
		<br/><br/>
		The objective of the job is simple: <b>to build production-ready
		quality of the project/app in a reproducible consistency
		manner</b>.
		<br/><br/>
		All users has to do is to issue this command:
{{% highlight bash "linenos=table,hl_lines=,linenostart=1" %}}
montuer build
{{% /highlight %}}
	</p>
</section>




<section id="job-level-configurations">
	<h2>Job Level Configurations</h2>
{{% ciJob/jobLevelConfigs "en" "build" /%}}
{{% ciJob/jobLevelVariables "en" "build" /%}}
</section>




<section id="recipe-configuration-file">
	<h2>Recipe Configuration File</h2>
{{% ciJob/recipeLevelConfigs "en" "build" /%}}


	<section id="recipe-metadata-section">
		<h3>Recipe's Metadata Section</h3>
		<p>
			The recipe's metadata section consists of the following
			fields:
{{% highlight bash "linenos=table,hl_lines=,linenostart=1" %}}
[Metadata]
Name = 'Clean Up Build Log Artifact'
Description = """
Clean up all artifacts for a job.
"""
{{% /highlight %}}
			<ul>
				<li><p>
					<code>Name</code> - used for recipe
					identification, reporting, and
					referencing usage. Monteur recommends
					<b>keeping it short, concise and without
					any weird symbols (e.g. space will be
					replaced by short dash
					(<code>-</code>))</b>.
				</p></li>
				<li><p>
					<code>Description</code> - mainly for
					logging and reporting purposes.
					<b>Describe the details of the
					recipe.</b>
				</p></li>
			</ul>
		</p>
	</section>


	<section id="recipe-variables-section">
		<h3>Recipe's Variables Section</h3>
		<p>
			The Monteur's <a href="{{< link
				"/internals/variables-processing/"
				"this"
				"url-only" />}}">Variables Processing</a>
			features. All variables defined in this recipe's
			configuration file <b>only visible to this recipe</b>.
			It is highly recommended to abstract as much variables
			away from your command algorithm as possible so that
			your user only has to customize these tables and not
			messing with your algorithm.
			<br/><br/>
			The variables section consists of the following
			fields:
{{% highlight bash "linenos=table,hl_lines=,linenostart=1" %}}
[Variables]
PlatformOS = 'linux'
PlatformCPU = 'amd64'
PlatformExt = ''
BuildConditions = 'CGO_ENABLED=0'
BuildFlags = """\
-buildmode=pie \
-ldflags "-s -w" \
-trimpath \
-gcflags "-trimpath=${GOPATH}" \
-asmflags "-trimpath=${GOPATH}" \
"""

[FMTVariables]
SrcPath = '{{- .BaseDir -}}/app/monteur/main.go'
BuildPath = """
{{- .WorkingDir -}}/{{- .PlatformOS -}}-{{- .PlatformCPU -}}{{- .PlatformExt -}}
"""
{{% /highlight %}}
			<ul>
				<li><p>
					<code>[Variables]</code> - plain
					variables list complying to
					<a href="{{< link
						"/internals/variables-processing/#plain-variables-definition"
						"this"
						"url-only" />}}">
						Montuer Plain Variables
						Definition</a>.
				</p></li>
				<li><p>
					<code>[FMTVariables]</code> -
					formattable variables list complying to
					<a href="{{< link
						"/internals/variables-processing/#formattable-variables-definition"
						"this"
						"url-only" />}}">
						Montuer Formattable Variables
						Definition</a>.
				</p></li>
			</ul>
		</p>
	</section>


	<section id="recipe-dependencies-section">
		<h3>Recipe's Dependencies Checking Section</h3>
		<p>
			The Monteur's <a href="{{< link
				"/internals/dependencies-checking/"
				"this"
				"url-only" />}}">Dependencies Checking</a>
			features. All dependencies here are checked against the
			running operating system to ensure proper operations.
			It is highly recommended to abstract as much
			dependencies into this list and away from your command
			algorithm as possible so that your user can check
			through the list without messing with your algorithm.
			<br/><br/>
			The dependencies checking section consists of the
			following fields:
{{% highlight bash "linenos=table,hl_lines=,linenostart=1" %}}
[[Dependencies]]
Name = 'Go'
Condition = 'all-all'
Type = 'command'
Command = 'go'

[[Dependencies]]
Name = 'Git for version control'
Condition = 'all-all'
Type = 'command'
Command = 'git'
{{% /highlight %}}
			<ul>
				<li><p>
					<code>[[Dependencies]]</code> - a
					dependency entry complying to
					<a href="{{< link
						"/internals/dependencies-checking/"
						"this"
						"url-only" />}}">
						Montuer Dependencies Checking
						Function</a>. The double square
						bracquets is the TOML formatting
						of an array entry to a list.
						Hence, you can add as many as
						you need shown above.
				</p></li>
			</ul>
		</p>
	</section>


	<section id="recipe-commands-section">
		<h3>Recipe's Commands Section</h3>
		<p>
			The list of executing commands complying to
			compliant to <a href="{{< link
						"/internals/commands/"
						"this"
						"url-only" />}}">Commands
				Execution Unit (CEU) Specification</a>.
			The commands are executed AFTER the recipe executed its
			meta processing processes.
			<br/><br/>
			The data structure is entirely based on the
			<a href="{{< link "/internals/commands/"
				"this"
				"url-only" />}}">Commands Execution Unit (CEU)
			Specification</a>. An example of this recipe's commands
			section would be:
{{% highlight bash "linenos=table,hl_lines=,linenostart=1" %}}
...

[[CMD]]
Name = "Create Build Directory to House the Compiled Binary"
Type = 'create-path'
Condition = [ 'all-all' ]
Source = '{{- .WorkingDir -}}'

[[CMD]]
Name = "Build the Go Binary"
Type = 'command'
Condition = [ 'all-all' ]
Location = '{{- .BaseDir -}}'
Source = """
{{- .BuildConditions }} \
GOOS="{{- .PlatformOS -}}" \
GOARCH="{{- .PlatformCPU -}}" \
go build {{ .BuildFlags }}  \
-o "{{- .BuildPath -}}" \
"{{- .SrcPath -}}"
"""
{{% /highlight %}}
		Currently, this is the last section of the recipe configuration
		file.
		</p>
	</section>
</section>




{{% ciJob/knownRecipes "en" "build" /%}}
